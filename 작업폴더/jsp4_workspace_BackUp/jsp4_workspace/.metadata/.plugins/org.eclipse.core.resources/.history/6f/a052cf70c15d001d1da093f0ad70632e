package com.shinnaHotel.reservation;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.shinnaHotel.DAO.ReservationDAO;
import com.shinnaHotel.DTO.ReservationDTO;
import com.shinnaHotel.action.Action;
import com.shinnaHotel.action.ActionForward;

public class ReservationCheckAction implements Action{

	@Override
	public ActionForward execute(HttpServletRequest req, HttpServletResponse resp) {
		ReservationDAO rdao = new ReservationDAO();
		ReservationDTO rdto = new ReservationDTO();
		
		ActionForward forward = new ActionForward();
		
//		
		
		// 체크인, 체크아웃 String -> Date로 변환
		String checkInDateSTR = req.getParameter("checkin_date");
		String CheckOutDateSTR = req.getParameter("checkout_date");
		SimpleDateFormat formatter = new SimpleDateFormat("yyyy-mm-dd");
		Date checkIn;
		Date checkOut;
		try {
			checkIn = formatter.parse(checkInDateSTR);
			checkOut = formatter.parse(CheckOutDateSTR);
			rdto.setRes_checkin(checkIn);
			rdto.setRes_checkout(checkOut);
			rdto.setRes_adults(Integer.parseInt(req.getParameter("adults")));
			rdto.setRes_kids(Integer.parseInt(req.getParameter("children")));
	
		} catch (ParseException e) {
			e.printStackTrace();
		}
		
		
		
		
		req.setAttribute("RoomList", rdao.searchRoom(param));
		req.setAttribute("param", param);
		
		forward.setRedirect(false);
		forward.setPath("reservationcheck.jsp");
		
		return forward;
	
	}

}
